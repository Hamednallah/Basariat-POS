<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Priority?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.VBox?>

<BorderPane fx:id="salesOrderFormRootPane" styleClass="dialog-container-large" xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.basariatpos.ui.controller.SalesOrderFormDialogController">
    <padding>
        <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
    </padding>
    <top>
        <VBox spacing="10">
            <Label fx:id="dialogTitleLabel" styleClass="dialog-title" text="%salesorder.form.add.title" />
            <GridPane hgap="10" vgap="8">
                <columnConstraints>
                    <ColumnConstraints halignment="RIGHT" hgrow="NEVER" minWidth="100.0" />
                    <ColumnConstraints hgrow="ALWAYS" minWidth="200.0" />
                    <ColumnConstraints halignment="RIGHT" hgrow="NEVER" minWidth="100.0" />
                    <ColumnConstraints hgrow="ALWAYS" minWidth="200.0" />
                </columnConstraints>
                <rowConstraints>
                    <RowConstraints minHeight="30.0" valignment="CENTER" vgrow="SOMETIMES" />
                    <RowConstraints minHeight="30.0" valignment="CENTER" vgrow="SOMETIMES" />
                    <RowConstraints minHeight="60.0" valignment="TOP" vgrow="SOMETIMES" />
                </rowConstraints>

                <Label text="%salesorder.form.label.patient" GridPane.columnIndex="0" GridPane.rowIndex="0" styleClass="form-label"/>
                <HBox spacing="5" alignment="CENTER_LEFT" GridPane.columnIndex="1" GridPane.rowIndex="0">
                    <TextField fx:id="patientDisplayField" styleClass="form-input-display" editable="false" HBox.hgrow="ALWAYS"/>
                    <Button fx:id="findPatientButton" text="%salesorder.form.button.findPatient" onAction="#handleFindPatientButtonAction" styleClass="form-button-standard"/>
                </HBox>

                <Label text="%salesorder.form.label.orderDate" GridPane.columnIndex="2" GridPane.rowIndex="0" styleClass="form-label"/>
                <DatePicker fx:id="orderDateField" styleClass="form-input" GridPane.columnIndex="3" GridPane.rowIndex="0" />

                <Label text="%salesorder.form.label.status" GridPane.columnIndex="0" GridPane.rowIndex="1" styleClass="form-label"/>
                <ComboBox fx:id="statusComboBox" styleClass="form-input" GridPane.columnIndex="1" GridPane.rowIndex="1" prefWidth="200"/>

                <Label text="%salesorder.form.label.remarks" GridPane.columnIndex="2" GridPane.rowIndex="1" styleClass="form-label" valignment="TOP"/>
                <TextArea fx:id="remarksArea" styleClass="form-input" GridPane.columnIndex="3" GridPane.rowIndex="1" GridPane.rowSpan="2" prefHeight="80.0" wrapText="true"/>
            </GridPane>
        </VBox>
    </top>

    <center>
        <VBox spacing="10" BorderPane.alignment="CENTER">
            <BorderPane.margin><Insets top="15.0" bottom="15.0"/></BorderPane.margin>
            <Label text="%salesorder.form.label.items" styleClass="form-section-label"/>
            <TableView fx:id="salesOrderItemsTable" editable="true" styleClass="table-view-editable" VBox.vgrow="ALWAYS" prefHeight="250.0">
                <columns>
                    <TableColumn fx:id="itemTypeColumn" text="%salesorder.item.header.type" prefWidth="120.0" />
                    <TableColumn fx:id="itemSelectionColumn" text="%salesorder.item.header.item" prefWidth="250.0" />
                    <TableColumn fx:id="itemDescriptionColumn" text="%salesorder.item.header.description" prefWidth="200.0" />
                    <TableColumn fx:id="itemQtyColumn" text="%salesorder.item.header.qty" prefWidth="70.0" styleClass="table-column-center-numeric"/>
                    <TableColumn fx:id="itemUnitPriceColumn" text="%salesorder.item.header.unitPrice" prefWidth="100.0" styleClass="table-column-amount"/>
                    <TableColumn fx:id="itemSubtotalColumn" text="%salesorder.item.header.subtotal" prefWidth="120.0" styleClass="table-column-amount"/>
                </columns>
                <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/></columnResizePolicy>
            </TableView>
            <HBox spacing="10" alignment="CENTER_LEFT">
                <Button fx:id="addItemButton" text="%salesorder.item.button.add" onAction="#handleAddItemButtonAction" styleClass="form-button-standard"/>
                <Button fx:id="removeItemButton" text="%salesorder.item.button.remove" onAction="#handleRemoveItemButtonAction" styleClass="form-button-danger"/>
                <Button fx:id="configureLensButton" text="%salesorder.item.button.configureLens" onAction="#handleConfigureLensButtonAction" styleClass="form-button-standard" visible="false" managed="false"/>
            </HBox>
        </VBox>
    </center>

    <bottom>
        <VBox spacing="10">
             <GridPane hgap="10" vgap="5" styleClass="summary-grid">
                <columnConstraints>
                    <ColumnConstraints halignment="RIGHT" hgrow="NEVER" minWidth="100.0"/>
                    <ColumnConstraints hgrow="SOMETIMES" minWidth="120.0"/>
                    <ColumnConstraints halignment="RIGHT" hgrow="NEVER" minWidth="100.0"/>
                    <ColumnConstraints hgrow="SOMETIMES" minWidth="120.0"/>
                </columnConstraints>
                 <Label text="%salesorder.form.label.subtotal" GridPane.columnIndex="0" GridPane.rowIndex="0" styleClass="summary-label"/>
                 <Label fx:id="subtotalAmountLabel" text="0.00" styleClass="summary-value" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                 <Label text="%salesorder.form.label.discount" GridPane.columnIndex="0" GridPane.rowIndex="1" styleClass="summary-label"/>
                 <TextField fx:id="discountField" text="0.00" styleClass="summary-input-numeric" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                 <Label text="%salesorder.form.label.totalAmount" GridPane.columnIndex="2" GridPane.rowIndex="0" styleClass="summary-label-total"/>
                 <Label fx:id="totalAmountLabel" text="0.00" styleClass="summary-value-total" GridPane.columnIndex="3" GridPane.rowIndex="0"/>

                 <Label text="%salesorder.form.label.amountPaid" GridPane.columnIndex="2" GridPane.rowIndex="1" styleClass="summary-label"/>
                 <TextField fx:id="amountPaidField" text="0.00" styleClass="summary-input-numeric" GridPane.columnIndex="3" GridPane.rowIndex="1"/>

                 <Label text="%salesorder.form.label.balanceDue" GridPane.columnIndex="2" GridPane.rowIndex="2" styleClass="summary-label-prominent"/>
                 <Label fx:id="balanceDueLabel" text="0.00" styleClass="summary-value-prominent" GridPane.columnIndex="3" GridPane.rowIndex="2"/>
             </GridPane>
            <HBox alignment="CENTER_RIGHT" spacing="10" styleClass="dialog-button-bar">
                <Button fx:id="notifyOrderReadyButton" text="%salesorder.button.notifyOrderReady" onAction="#handleNotifyOrderReadyButtonAction" styleClass="button-standard" visible="false" managed="false" prefWidth="220"/>
                <Button fx:id="recordPaymentButton" text="%salesorder.button.recordPayment" onAction="#handleRecordPaymentButtonAction" styleClass="button-success" disable="true" prefWidth="160"/>
                <HBox HBox.hgrow="ALWAYS"/> <!-- Spacer -->
                <Button fx:id="saveOrderButton" text="%dialog.button.save" onAction="#handleSaveOrderButtonAction" styleClass="button-primary" defaultButton="true" prefWidth="100"/>
                <Button fx:id="cancelButton" text="%dialog.button.cancel" onAction="#handleCancelButtonAction" styleClass="button-secondary" cancelButton="true" prefWidth="100"/>
            </HBox>
        </VBox>
    </bottom>
</BorderPane>
